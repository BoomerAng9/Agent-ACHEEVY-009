{
  "service": "aims-whatsapp-webhook",
  "endpoint": "/api/whatsapp/webhook",
  "status": "implemented",
  "features": {
    "webhook_verification": "GET with hub.mode=subscribe + hub.verify_token",
    "inbound_messages": "Parses WhatsApp Cloud API webhook payload (entry.changes.value.messages)",
    "account_linking": "User sends 'link' → receives 6-char code → claims in dashboard",
    "outbound_replies": "Uses WhatsApp Cloud API (graph.facebook.com/v18.0/<PHONE_ID>/messages)",
    "gateway_routing": "Linked messages forward to /api/social/gateway as NormalizedMessage"
  },
  "required_env": [
    "WHATSAPP_VERIFY_TOKEN",
    "WHATSAPP_API_TOKEN",
    "WHATSAPP_PHONE_NUMBER_ID"
  ],
  "smoke_test": {
    "GET_health": "Returns { service, status } — shows configured/missing_token",
    "POST_link": "Simulated inbound 'link' message → generates code → sends via WhatsApp API",
    "POST_message": "Simulated linked user message → forwards to /api/social/gateway"
  }
}
